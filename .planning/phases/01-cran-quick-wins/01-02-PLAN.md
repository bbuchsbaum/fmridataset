---
phase: 01-cran-quick-wins
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - R/golden_data_generation.R
  - R/all_generic.R
autonomous: true

must_haves:
  truths:
    - "R CMD check produces no NOTE about undefined global function generate_all_golden_data"
    - "R CMD check produces no NOTE about Rd cross-reference missing package anchor"
  artifacts:
    - path: "R/all_generic.R"
      provides: "Properly anchored cross-package documentation links"
      contains: "fmrihrf::sampling_frame"
      min_lines: 200
  key_links:
    - from: "R/all_generic.R"
      to: "fmrihrf package"
      via: "roxygen2 cross-reference"
      pattern: "fmrihrf::sampling_frame"
---

<objective>
Fix code issues: delete golden data generation file and fix cross-package documentation link

Purpose: CRAN-02 requires fixing the architectural issue where generate_golden_test_data() calls generate_all_golden_data() which only exists in tests/. CRAN-03 requires adding package anchor to sampling_frame cross-reference.

Output: Clean R code without undefined globals and properly anchored Rd cross-references.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-cran-quick-wins/01-RESEARCH.md

@R/golden_data_generation.R
@R/all_generic.R
@tests/testthat/helper-golden.R
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete golden data generation file</name>
  <files>R/golden_data_generation.R</files>
  <action>
Delete R/golden_data_generation.R entirely.

Rationale: These are development-time test utilities (generate_golden_test_data, update_golden_test_data, validate_golden_test_data) that belong in tests/testthat/helper-golden.R, not in the package's R/ directory. The @export was an architectural mistake - user-facing packages should not export test data generation utilities.

The functionality already exists in tests/testthat/helper-golden.R where it belongs. Deleting this file eliminates the undefined global reference to generate_all_golden_data() and removes inappropriate exports from the package API.

Steps:
1. Delete the file: rm R/golden_data_generation.R
2. Run devtools::document() to update NAMESPACE (remove the exports)
  </action>
  <verify>
Run: ls R/golden_data_generation.R
Expected: "No such file or directory" error (file deleted)

Run: grep "generate_golden_test_data" NAMESPACE
Expected: No matches (export removed)
  </verify>
  <done>R/golden_data_generation.R deleted and NAMESPACE no longer exports golden data functions</done>
</task>

<task type="auto">
  <name>Task 2: Fix sampling_frame cross-reference in get_TR documentation</name>
  <files>R/all_generic.R</files>
  <action>
In R/all_generic.R, find the get_TR documentation (around line 273) which contains:
```r
#' \code{\link{sampling_frame}} for creating temporal structures,
```

Replace with properly anchored cross-package reference:
```r
#' [fmrihrf::sampling_frame()] for creating temporal structures,
```

This uses roxygen2's markdown link syntax which generates proper package-anchored Rd links.

After editing, run: R -e "devtools::document()" to regenerate man/get_TR.Rd with the correct link.
  </action>
  <verify>
1. grep "fmrihrf::sampling_frame" R/all_generic.R should show the updated reference
2. After running devtools::document(), grep "sampling_frame" man/get_TR.Rd should show proper package anchor
  </verify>
  <done>R/all_generic.R uses [fmrihrf::sampling_frame()] syntax and man/get_TR.Rd has proper package anchor</done>
</task>

</tasks>

<verification>
After both tasks, run devtools::document() then devtools::check():
```bash
R -e "devtools::document(); devtools::check()" 2>&1 | grep -E "generate_all_golden_data|sampling_frame|missing package anchors"
```

Expected: No matches (issues resolved).
</verification>

<success_criteria>
- R/golden_data_generation.R does not exist (deleted)
- NAMESPACE does not export generate_golden_test_data, update_golden_test_data, validate_golden_test_data
- R CMD check no longer produces NOTE about undefined global function generate_all_golden_data
- R CMD check no longer produces NOTE about Rd cross-reference missing package anchor for sampling_frame
- Package still builds and passes existing tests
</success_criteria>

<output>
After completion, create `.planning/phases/01-cran-quick-wins/01-02-SUMMARY.md`
</output>
