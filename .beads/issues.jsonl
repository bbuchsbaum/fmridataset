{"id":"fmridataset-0k0","title":"Align python latent_dataset get_mask with R component-mask semantics","description":"R latent_dataset.get_mask returns n_components logical mask; python currently inherits backend voxel-mask. Update LatentDataset.get_mask and add regression.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:32:53.307977Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:33:03.253872Z","closed_at":"2026-02-17T12:33:03.253872Z","close_reason":"get_mask now returns component-level logical mask matching R semantics; regression test added.","source_repo":".","compaction_level":0}
{"id":"fmridataset-1vy","title":"Validate run_length strictly in latent_dataset","description":"latent_dataset currently casts run_length with int(), allowing silent truncation of non-integer inputs unlike other constructors; add strict integer validation and regression.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:28:14.516362Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:28:21.443936Z","closed_at":"2026-02-17T12:28:21.443936Z","close_reason":"Rejects non-integer run_length in latent_dataset using shared _coerce_run_length validation and adds regression test.","source_repo":".","compaction_level":0}
{"id":"fmridataset-2f1","title":"Fix run_length truncation in constructors","description":"Python _coerce_run_length in dataset_constructors already enforces integer run_length values via float.is_integer() and raises ValueError('run_length values must be integers'). Existing regressions in python/tests/test_dataset.py cover non-integer paths.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:27:21.079689Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:27:39.178703Z","closed_at":"2026-02-17T12:27:39.178703Z","close_reason":"Rejects non-integer run_length before sum validation and adds regression tests for matrix_dataset + fmri_dataset.","source_repo":".","compaction_level":0}
{"id":"fmridataset-2sz","title":"Support file:// URIs in zarr_backend","description":"Implemented zarr backend file:// URI support by extending remote-source detection in backend_open.zarr_backend. Added regression test in tests/testthat/test_zarr_backend.R. Regression test pass verified: test_zarr_backend.R and test_zarr_dataset_constructor.R with Rscript test_file(...).","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:23:53.142920Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:24:22.519947Z","closed_at":"2026-02-17T12:24:22.519950Z","source_repo":".","compaction_level":0}
{"id":"fmridataset-3aj","title":"Normalize empty event_table in Python constructor","description":"Python matrix/FmriDataset constructors now normalize zero-column/None event_table inputs to event_index-only frame for R parity; added regression tests in python/tests/test_dataset.py (default_event_table_has_event_index, empty_event_table_is_normalized).","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:25:01.046690Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:25:17.525752Z","closed_at":"2026-02-17T12:25:17.525752Z","close_reason":"Implemented parity-compatible default empty event_table normalization in matrix_dataset/FmriDataset and added/validated regression tests in python/tests/test_dataset.py.","source_repo":".","compaction_level":0}
{"id":"fmridataset-54z","title":"Mirror fmri_study_dataset run_id injection/warning in Python study_dataset","description":"Python study_dataset was missing R parity behavior: fmri_study_dataset adds run_id when absent and warns when dataset has multiple runs. Added warning + run_id injection for each subject plus regression in test_study_dataset.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:33:10.179588Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:33:11.979331Z","closed_at":"2026-02-17T12:33:11.979331Z","close_reason":"Implemented run_id parity in study_dataset: adds subject_id/run_id (with warning) when run_id missing, matching R behavior; added regression test validating inferred run_id and warning.","source_repo":".","compaction_level":0}
{"id":"fmridataset-63r","title":"matrix_dataset should reject/flatten non-2D datamat like R as.matrix","description":"Updated matrix_dataset datamat coercion: non-2D arrays now flatten with order='F' to a (n,1) matrix, matching R as.matrix behavior for >2D inputs. Added regression test test_multi_dimensional_datamat_flattens_like_r_as_matrix.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:28:12.857166Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:28:25.510874Z","closed_at":"2026-02-17T12:28:25.510874Z","close_reason":"Fixed matrix_dataset to reshape non-2D datamat inputs via np.reshape(-1,1,order='F') before validation, matching R as.matrix semantics; added regression in python/tests/test_dataset.py (test_multi_dimensional_datamat_flattens_like_r_as_matrix), pytest passes (19 passed).","source_repo":".","compaction_level":0}
{"id":"fmridataset-au8","title":"test-as_delarr.R omits loading package namespace","description":"Fixed isolated execution of test-as_delayed_array.R by loading package namespace and invoking internal delayed-array registration via fmridataset:::register_delayed_array_support(). Regression: Rscript -e 'testthat::test_file(tests/testthat/test-as_delayed_array.R)' now passes (1 skip).","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:25:30.405391Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:26:17.156695Z","closed_at":"2026-02-17T12:25:48.327645Z","close_reason":"Added namespace guard (library(fmridataset)) and export assertions so as_delarr tests run in testthat helper context.","source_repo":".","compaction_level":0}
{"id":"fmridataset-c0g","title":"Normalize default Python matrix_dataset event_table schema for parity with R","description":"Python matrix_dataset default event_table was empty (0x0) causing rpy2 conversion/parity test failures. Added parity-safe schema default with event_index column to match R behavior; added regression in python/tests/test_dataset.py.","status":"closed","priority":1,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:25:00.194604Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:25:02.833911Z","closed_at":"2026-02-17T12:25:02.833911Z","close_reason":"Fix implemented and regression verified","source_repo":".","compaction_level":0}
{"id":"fmridataset-ep9","title":"Python matrix_dataset vector input should be column matrix","description":"R matrix_dataset accepts 1D vectors as column matrices via as.matrix(). Python currently reshapes 1D arrays to 1xN rows using np.atleast_2d, causing run_length mismatches and incorrect orientation. Fix by reshaping 1D inputs to (-1,1) and adding regression coverage.","status":"closed","priority":2,"issue_type":"bug","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:19:43.246244Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:25:29.327450Z","closed_at":"2026-02-17T12:25:29.327450Z","close_reason":"Implemented vector input parity fix (reshape 1D to column matrix) and added tests in python/tests/test_dataset.py","source_repo":".","compaction_level":0,"labels":["matrix_dataset","parity","python"]}
{"id":"fmridataset-f42","title":"Infer run_length in latent_dataset when omitted","description":"R latent_dataset allows run_length=NULL/empty to infer per-file lengths from backend; Python currently requires run_length. Add inference fallback and update signature/tests.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:30:50.696352Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:31:08.782183Z","closed_at":"2026-02-17T12:31:08.782183Z","close_reason":"latent_dataset now allows optional run_length; infers per-source lengths from LatentBackend.run_lengths when omitted or zero, matching R behavior.","source_repo":".","compaction_level":0}
{"id":"fmridataset-fn7","title":"Add components filtering to python latent loadings","description":"Parity gap: Python LatentDataset.get_spatial_loadings lacks components argument present in R","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:32:25.416170Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:33:03.095463Z","closed_at":"2026-02-17T12:33:03.095463Z","close_reason":"Added components selector to LatentDataset.get_spatial_loadings with regression coverage.","source_repo":".","compaction_level":0}
{"id":"fmridataset-jgh","title":"Ported api parity: study dataset and h5/new_fmri_series visibility regressions","description":"fmridataset test suite shows stale S3 dispatch/visibility regressions:  on  returns NULL, required h5_backend method symbols  are not exported/visible, and  is not exported in test context.","notes":"Fixed: added @export to new_fmri_series in R/FmriSeries.R; added regression in tests/testthat/test_api_safety.R asserting exported namespace includes %||%, new_fmri_series, and h5_backend methods backend_open/close/get_dims/get_mask/get_data/get_metadata. Validation: Rscript -e \"devtools::load_all(quiet=TRUE); testthat::test_file('tests/testthat/test_api_safety.R', reporter='summary')\" => api_safety PASS.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:28:21.847164Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:32:30.399753Z","closed_at":"2026-02-17T12:32:30.399753Z","close_reason":"fixed by exporting new_fmri_series and adding namespace regression test; verified API safety test file passes","source_repo":".","compaction_level":0}
{"id":"fmridataset-ld3","title":"Align default event_table parity for backend-backed fmri and latent datasets","description":"Python FmriDataset currently adds an  column for any zero-column event_table, so fmri_dataset()/latent_dataset() return 0x1 tables. R constructors keep default event_table as true empty 0x0. Move event_table normalization to matrix_dataset only to restore constructor parity and add regressions for fmri/latent defaults.","status":"closed","priority":2,"issue_type":"bug","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:29:08.375227Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:29:20.314603Z","closed_at":"2026-02-17T12:29:20.314603Z","close_reason":"Restored parity by removing global zero-column event_table normalization from FmriDataset.__init__ and added regressions confirming fmri_dataset()/latent_dataset() default event_table remains empty (0x0) like R.","source_repo":".","compaction_level":0}
{"id":"fmridataset-meo","title":"Avoid zero-column event_table in matrix_dataset for Python parity","description":"Added matrix_dataset default event_table normalization to avoid zero-column tables and added regression test ensuring non-empty schema by default in test_api_safety.R. Verified with parity and API tests.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:23:20.475904Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:24:21.327321Z","closed_at":"2026-02-17T12:24:21.327324Z","source_repo":".","compaction_level":0}
{"id":"fmridataset-mvn","title":"Resolve base_path in latent_dataset source paths","description":"R latent_dataset applies base_path to relative source files; Python currently passes source paths directly so  fails unless cwd matches. Add base_path resolution and regression.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:29:39.436416Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:29:53.797108Z","closed_at":"2026-02-17T12:29:53.797108Z","close_reason":"latent_dataset now resolves relative source paths against base_path (like R) and regression covers creating dataset from relative.lv.h5 with explicit base_path.","source_repo":".","compaction_level":0}
{"id":"fmridataset-noh","title":"Clarify fmri_dataset deprecated backend argument contract","description":"Regression in tests/testthat/test_additional_cases.R: deprecated backend argument now requires storage backend object; verified with devtools::load_all and test_file.","status":"closed","priority":2,"issue_type":"bug","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:21:38.828837Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:27:15.664854Z","closed_at":"2026-02-17T12:27:15.664854Z","close_reason":"Source already has explicit deprecated backend guard and message; validated by devtools::load_all; test_file(test_additional_cases.R) passes. Test checks fmri_dataset(..., backend=\"nifti\") errors with explicit storage-backend-object contract.","source_repo":".","compaction_level":0}
{"id":"fmridataset-o54","title":"Reject character run_length in python constructors","description":"R dataset constructors reject character run_length (e.g., \"2\") with invalid type errors, but Python currently accepted it via float coercion. Added shared-run_length guard in _coerce_run_length and regression tests in python/tests/test_dataset.py for matrix_dataset and fmri_dataset.","notes":"Fix in _coerce_run_length: reject (str, bytes)-like run_length values before float conversion; regression tests added in python/tests/test_dataset.py for matrix_dataset and fmri_dataset.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:29:05.201220Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:29:08.959917Z","closed_at":"2026-02-17T12:29:08.959920Z","source_repo":".","compaction_level":0}
{"id":"fmridataset-rln","title":"Align python latent_dataset get_mask with R component mask and add regression","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-17T12:33:34.406815Z","updated_at":"2026-02-17T12:33:36.229112Z","closed_at":"2026-02-17T12:33:36.229112Z","close_reason":"Closed","source_repo":".","compaction_level":0}
{"id":"fmridataset-t1s","title":"test_as_delarr.R requires package namespace load","description":"tests/testthat/test_as_delarr.R runs functions from fmridataset without attaching the package namespace and can fail when executed standalone; add library(fmridataset) + regression assertions.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:26:10.682994Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:26:12.930140Z","closed_at":"2026-02-17T12:26:12.930140Z","close_reason":"Added library(fmridataset) and export availability check to tests/testthat/test_as_delarr.R; verified via Rscript testthat::test_file('tests/testthat/test_as_delarr.R').","source_repo":".","compaction_level":0}
{"id":"fmridataset-ulp","title":"Infer latent run_length for 0/empty aliases","description":"Python latent_dataset should mirror R behavior where run_length=NULL/0/empty triggers backend-per-file run-length inference instead of strict validation.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:31:30.948929Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:31:39.313626Z","closed_at":"2026-02-17T12:31:39.313626Z","close_reason":"Added latent run_length inference when None/0/empty, added tests for omitted/0/empty multi-source, and guarded run-length cache reset on reopen in LatentBackend.","source_repo":".","compaction_level":0}
{"id":"fmridataset-vra","title":"Enforce unique event_table columns in Python fmri_dataset and latent_dataset","description":"Python fmri_dataset/latent_dataset accepted duplicate event_table column names despite R using tibble::as_tibble(..., .name_repair='check_unique'). Add validation and regression tests.","status":"closed","priority":1,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:31:36.478448Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:31:39.140195Z","closed_at":"2026-02-17T12:31:39.140195Z","close_reason":"Added _ensure_event_table_unique in Python constructors, applied to fmri_dataset + latent_dataset, and added regression tests in python/tests/test_dataset.py and python/tests/test_latent_dataset.py.","source_repo":".","compaction_level":0}
{"id":"fmridataset-vuv","title":"rpy2 parity tests use deprecated numpy2ri.activate","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:23:29.226454Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:27:02.314003Z","closed_at":"2026-02-17T12:27:02.314003Z","close_reason":"Parity tests no longer use deprecated numpy2ri.activate; test_parity_dataset.py explicitly patches and asserts neither activate nor deactivate are called.","source_repo":".","compaction_level":0}
{"id":"fmridataset-wsb","title":"Export missing study/n_runs and backend constructors in fmridataset","description":"Fix regression: fmri_study_dataset n_runs and exported symbols required by tests.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T12:29:39.427231Z","created_by":"bbuchsbaum","updated_at":"2026-02-17T12:29:53.842884Z","closed_at":"2026-02-17T12:29:53.842884Z","close_reason":"Fixed n_runs study dataset dispatch, exported missing backend symbols, and exposed new_fmri_series; targeted regressions pass via devtools load_all tests.","source_repo":".","compaction_level":0}
