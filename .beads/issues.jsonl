{"id":"fmridataset-1vy","title":"Validate run_length strictly in latent_dataset","description":"latent_dataset currently casts run_length with int(), allowing silent truncation of non-integer inputs unlike other constructors; add strict integer validation and regression.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:28:14.516362-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:28:21.443936-05:00","closed_at":"2026-02-17T07:28:21.443936-05:00","close_reason":"Rejects non-integer run_length in latent_dataset using shared _coerce_run_length validation and adds regression test."}
{"id":"fmridataset-2f1","title":"Fix run_length truncation in constructors","description":"Python _coerce_run_length in dataset_constructors already enforces integer run_length values via float.is_integer() and raises ValueError('run_length values must be integers'). Existing regressions in python/tests/test_dataset.py cover non-integer paths.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:27:21.079689-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:27:39.178703-05:00","closed_at":"2026-02-17T07:27:39.178703-05:00","close_reason":"Rejects non-integer run_length before sum validation and adds regression tests for matrix_dataset + fmri_dataset."}
{"id":"fmridataset-2sz","title":"Support file:// URIs in zarr_backend","description":"Implemented zarr backend file:// URI support by extending remote-source detection in backend_open.zarr_backend. Added regression test in tests/testthat/test_zarr_backend.R. Regression test pass verified: test_zarr_backend.R and test_zarr_dataset_constructor.R with Rscript test_file(...).","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:23:53.14292-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:24:22.519947-05:00","closed_at":"2026-02-17T07:24:22.51995-05:00"}
{"id":"fmridataset-3aj","title":"Normalize empty event_table in Python constructor","description":"Python matrix/FmriDataset constructors now normalize zero-column/None event_table inputs to event_index-only frame for R parity; added regression tests in python/tests/test_dataset.py (default_event_table_has_event_index, empty_event_table_is_normalized).","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:25:01.04669-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:25:17.525752-05:00","closed_at":"2026-02-17T07:25:17.525752-05:00","close_reason":"Implemented parity-compatible default empty event_table normalization in matrix_dataset/FmriDataset and added/validated regression tests in python/tests/test_dataset.py."}
{"id":"fmridataset-63r","title":"matrix_dataset should reject/flatten non-2D datamat like R as.matrix","description":"Updated matrix_dataset datamat coercion: non-2D arrays now flatten with order='F' to a (n,1) matrix, matching R as.matrix behavior for \u003e2D inputs. Added regression test test_multi_dimensional_datamat_flattens_like_r_as_matrix.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:28:12.857166-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:28:25.510874-05:00","closed_at":"2026-02-17T07:28:25.510874-05:00","close_reason":"Fixed matrix_dataset to reshape non-2D datamat inputs via np.reshape(-1,1,order='F') before validation, matching R as.matrix semantics; added regression in python/tests/test_dataset.py (test_multi_dimensional_datamat_flattens_like_r_as_matrix), pytest passes (19 passed)."}
{"id":"fmridataset-au8","title":"test-as_delarr.R omits loading package namespace","description":"Fixed isolated execution of test-as_delayed_array.R by loading package namespace and invoking internal delayed-array registration via fmridataset:::register_delayed_array_support(). Regression: Rscript -e 'testthat::test_file(tests/testthat/test-as_delayed_array.R)' now passes (1 skip).","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:25:30.405391-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:26:17.156695-05:00","closed_at":"2026-02-17T07:25:48.327645-05:00","close_reason":"Added namespace guard (library(fmridataset)) and export assertions so as_delarr tests run in testthat helper context."}
{"id":"fmridataset-c0g","title":"Normalize default Python matrix_dataset event_table schema for parity with R","description":"Python matrix_dataset default event_table was empty (0x0) causing rpy2 conversion/parity test failures. Added parity-safe schema default with event_index column to match R behavior; added regression in python/tests/test_dataset.py.","status":"closed","priority":1,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:25:00.194604-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:25:02.833911-05:00","closed_at":"2026-02-17T07:25:02.833911-05:00","close_reason":"Fix implemented and regression verified"}
{"id":"fmridataset-ep9","title":"Python matrix_dataset vector input should be column matrix","description":"R matrix_dataset accepts 1D vectors as column matrices via as.matrix(). Python currently reshapes 1D arrays to 1xN rows using np.atleast_2d, causing run_length mismatches and incorrect orientation. Fix by reshaping 1D inputs to (-1,1) and adding regression coverage.","status":"closed","priority":2,"issue_type":"bug","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:19:43.246244-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:25:29.32745-05:00","closed_at":"2026-02-17T07:25:29.32745-05:00","close_reason":"Implemented vector input parity fix (reshape 1D to column matrix) and added tests in python/tests/test_dataset.py","labels":["matrix_dataset","parity","python"]}
{"id":"fmridataset-jgh","title":"Ported api parity: study dataset and h5/new_fmri_series visibility regressions","description":"fmridataset test suite shows stale S3 dispatch/visibility regressions:  on  returns NULL, required h5_backend method symbols  are not exported/visible, and  is not exported in test context.","status":"in_progress","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:28:21.847164-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:28:23.352862-05:00"}
{"id":"fmridataset-ld3","title":"Align default event_table parity for backend-backed fmri and latent datasets","description":"Python FmriDataset currently adds an  column for any zero-column event_table, so fmri_dataset()/latent_dataset() return 0x1 tables. R constructors keep default event_table as true empty 0x0. Move event_table normalization to matrix_dataset only to restore constructor parity and add regressions for fmri/latent defaults.","status":"closed","priority":2,"issue_type":"bug","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:29:08.375227-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:29:20.314603-05:00","closed_at":"2026-02-17T07:29:20.314603-05:00","close_reason":"Restored parity by removing global zero-column event_table normalization from FmriDataset.__init__ and added regressions confirming fmri_dataset()/latent_dataset() default event_table remains empty (0x0) like R."}
{"id":"fmridataset-meo","title":"Avoid zero-column event_table in matrix_dataset for Python parity","description":"Added matrix_dataset default event_table normalization to avoid zero-column tables and added regression test ensuring non-empty schema by default in test_api_safety.R. Verified with parity and API tests.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:23:20.475904-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:24:21.327321-05:00","closed_at":"2026-02-17T07:24:21.327324-05:00"}
{"id":"fmridataset-mvn","title":"Resolve base_path in latent_dataset source paths","description":"R latent_dataset applies base_path to relative source files; Python currently passes source paths directly so  fails unless cwd matches. Add base_path resolution and regression.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:29:39.436416-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:29:53.797108-05:00","closed_at":"2026-02-17T07:29:53.797108-05:00","close_reason":"latent_dataset now resolves relative source paths against base_path (like R) and regression covers creating dataset from relative.lv.h5 with explicit base_path."}
{"id":"fmridataset-noh","title":"Clarify fmri_dataset deprecated backend argument contract","description":"Regression in tests/testthat/test_additional_cases.R: deprecated backend argument now requires storage backend object; verified with devtools::load_all and test_file.","status":"closed","priority":2,"issue_type":"bug","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:21:38.828837-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:27:15.664854-05:00","closed_at":"2026-02-17T07:27:15.664854-05:00","close_reason":"Source already has explicit deprecated backend guard and message; validated by devtools::load_all; test_file(test_additional_cases.R) passes. Test checks fmri_dataset(..., backend=\"nifti\") errors with explicit storage-backend-object contract."}
{"id":"fmridataset-o54","title":"Reject character run_length in python constructors","description":"R dataset constructors reject character run_length (e.g., \"2\") with invalid type errors, but Python currently accepted it via float coercion. Added shared-run_length guard in _coerce_run_length and regression tests in python/tests/test_dataset.py for matrix_dataset and fmri_dataset.","notes":"Fix in _coerce_run_length: reject (str, bytes)-like run_length values before float conversion; regression tests added in python/tests/test_dataset.py for matrix_dataset and fmri_dataset.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:29:05.20122-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:29:08.959917-05:00","closed_at":"2026-02-17T07:29:08.95992-05:00"}
{"id":"fmridataset-t1s","title":"test_as_delarr.R requires package namespace load","description":"tests/testthat/test_as_delarr.R runs functions from fmridataset without attaching the package namespace and can fail when executed standalone; add library(fmridataset) + regression assertions.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:26:10.682994-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:26:12.93014-05:00","closed_at":"2026-02-17T07:26:12.93014-05:00","close_reason":"Added library(fmridataset) and export availability check to tests/testthat/test_as_delarr.R; verified via Rscript testthat::test_file('tests/testthat/test_as_delarr.R')."}
{"id":"fmridataset-vuv","title":"rpy2 parity tests use deprecated numpy2ri.activate","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:23:29.226454-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:27:02.314003-05:00","closed_at":"2026-02-17T07:27:02.314003-05:00","close_reason":"Parity tests no longer use deprecated numpy2ri.activate; test_parity_dataset.py explicitly patches and asserts neither activate nor deactivate are called."}
{"id":"fmridataset-wsb","title":"Export missing study/n_runs and backend constructors in fmridataset","description":"Fix regression: fmri_study_dataset n_runs and exported symbols required by tests.","status":"closed","priority":2,"issue_type":"task","owner":"brad.buchsbaum@gmail.com","created_at":"2026-02-17T07:29:39.427231-05:00","created_by":"bbuchsbaum","updated_at":"2026-02-17T07:29:53.842884-05:00","closed_at":"2026-02-17T07:29:53.842884-05:00","close_reason":"Fixed n_runs study dataset dispatch, exported missing backend symbols, and exposed new_fmri_series; targeted regressions pass via devtools load_all tests."}
