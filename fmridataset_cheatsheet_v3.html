<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>NA • fmridataset</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="NA"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">fmridataset</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/architecture-overview.html">Architecture Deep Dive: Design Principles and Extensibility</a></li>
    <li><a class="dropdown-item" href="articles/backend-development-basics.html">Backend Development Basics: Creating Custom Storage Backends</a></li>
    <li><a class="dropdown-item" href="articles/backend-registry.html">Backend Registry: Extending Data Format Support</a></li>
    <li><a class="dropdown-item" href="articles/extending-backends.html">Advanced Backend Development: Storage Extensions</a></li>
    <li><a class="dropdown-item" href="articles/fmridataset-intro.html">Getting Started with fmridataset</a></li>
    <li><a class="dropdown-item" href="articles/h5-backend-usage.html">HDF5 Storage: High-Performance Data Management for Large-Scale fMRI Studies</a></li>
    <li><a class="dropdown-item" href="articles/study-level-analysis.html">Scaling to Study-Level Analysis: From Single Subjects to Group Studies</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbuchsbaum/fmridataset/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>NA</h1>
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/fmridataset/blob/main/fmridataset_cheatsheet_v3.md" class="external-link"><code>fmridataset_cheatsheet_v3.md</code></a></small>
    </div>

<div class="section level2">
<h2 id="micro-dsl-v34-source-format-grammar">Micro-DSL v3.4 Source Format Grammar<a class="anchor" aria-label="anchor" href="#micro-dsl-v34-source-format-grammar"></a></h2>
<p>This is the HUMAN-READABLE source format for v3.4. It extends v3.3 with semantic annotations and constrained types while maintaining clarity and completeness. A separate compilation step produces the compressed format.</p>
<p><strong>Budget</strong>: Target ≤ 250 lines or ≤ 2,500 tokens for optimal LLM processing.</p>
<p><strong>1. Document Structure:</strong></p>
<pre><code>@pkg package_name | description
[Type Aliases section]
[Constraint Definitions section]
[Legend section if needed]
# Package Name
[Sections with entries]
[Dependencies section]
[Meta-Footer]</code></pre>
<p><strong>2. Sigils (Same as v3.3):</strong></p>
<pre><code>@pkg - Package declaration
@f   - Function
@d   - Data object
@x   - Re-export from another package

S3 System:
@s3g - S3 generic (UseMethod)
@s3m - S3 method (generic.class)
@s3c - S3 class definition

S4 System:
@s4g - S4 generic (setGeneric)
@s4m - S4 method (setMethod)
@s4c - S4 class (setClass)

S7 System:
@s7g - S7 generic (new_generic)
@s7m - S7 method
@s7c - S7 class (new_class)

R6 System:
@r6c - R6 class (R6Class)</code></pre>
<p><strong>3. Type System (v3.4 Enhanced with Constraints):</strong></p>
<pre><code>Scalars (default): int, dbl, chr, lgl, raw, cpl
Vectors: vec&lt;type&gt; or type[]
Matrices: mat&lt;type&gt; or mat&lt;type,rows,cols&gt;
Arrays: arr&lt;type,dims&gt;
Lists: lst&lt;type&gt; or lst{field:type, ...} (structured)
Data frames: df, tbl, data.table
Factors: fct, ord
Dates: Date, POSIXct, POSIXlt

Union types: type1|type2|type3
Nullable: type? (shorthand for type|NULL)
Any type: any
Ellipsis: ... or ...:type (e.g., ...:expr for NSE)

Class types: s3:classname, s4:classname, r6:classname, s7:classname

CONSTRAINED TYPES (v3.4):
Enums: chr["opt1"|"opt2"|"opt3"]
Ranges: int[min..max], dbl[min..max]
Patterns: chr[/regex/]
Exclusions: int[1..100]&amp;!=[13,17]
References: @ref:constraint_name</code></pre>
<p><strong>4. Entry Format (v3.4 Enhanced):</strong></p>
<pre><code>@sigil name (param1:type1[constraint]?=default, param2:type2, ...) | Description -&gt; return_type | return_schema
  +tag:value +tag:value
  !cov [Class1, Class2] (for generics)
  - param1 : Additional description
    @annotation:value @annotation:value
  - param2 : (constants: "a", "b", CONST) Valid values
    @requires:condition @affects:target
  - param3 : (key_funcs: func1, func2) Related functions
    @lifecycle:init @units:measurement
  ```verbatim
  # Optional verbatim R code block</code></pre>
<pre><code>
**5. Type Aliases Section (v3.4 Enhanced):**
```markdown
## Type Aliases:
DF = df|tbl|data.table              # Standard data frame types
V&lt;T&gt; = vec&lt;T&gt;                       # Vector shorthand
Fml = s3:formula                    # Formula objects
Gg = s3:ggplot                      # ggplot2 objects
Config = lst{method:chr, opts:lst}  # Structured config
ValidPort = int[1024..65535]       # Constrained port range</code></pre>
<p><strong>Standard aliases</strong> (use these by default): - <code>DF</code> for data frame arguments - <code>Fml</code> for formula arguments (not <code>fml</code>) - <code>V&lt;T&gt;</code> for vectors when brevity helps</p>
<p><strong>6. Constraint Definitions (v3.4 New):</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">## Constraint Definitions:</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>@constraint positive_weights | Positive numeric weights</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  type: vec<span class="dt">&lt;</span><span class="kw">dbl</span><span class="dt">&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  validates: all(. &gt; 0)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  length: @env:nrow(data)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  </span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>@constraint valid_identifier | Valid R identifier</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  type: chr</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  pattern: /^<span class="co">[</span><span class="ot">a-zA-Z_</span><span class="co">][a-zA-Z0-9_.]</span>*$/</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  not_reserved: TRUE</span></code></pre></div>
<p><strong>7. Class Documentation (v3.4 Enhanced):</strong></p>
<pre><code>@s4c ClassName | One-line description
  - slots: name1 (type1[constraint]) @annotation:value
           name2 (type2) @lifecycle:init @immutable
  - extends: ParentClass
  - validity: Description of validity rules

@r6c ClassName | One-line description
  - fields: field1 (type1[constraint]) @purpose:role
            field2 (type2) @lazy @cached
  - methods: method1 (args) -&gt; ret_type
             method2 (args) -&gt; ret_type
  - inherits: ParentClass</code></pre>
<p><strong>8. Metadata Tags (v3.3 + v3.4 additions):</strong></p>
<pre><code>+family:group_name           # Function family
+pipe:in|out                # Pipe compatibility (in, out, or both)
+nse:param1,param2          # Parameters using NSE
+side:effect[details]       # Side effects with sub-facets
  - fs[read|write|delete]   # File system operations
  - plot[device|file]       # Graphics output
  - console[print|message|warning]  # Console output
  - network[http|socket|download]   # Network operations
  - options[get|set|env]    # Global options/environment
  - db[read|write|query]    # Database operations
+perf:O(complexity)         # Performance complexity
+mem:usage                  # Memory usage pattern
+compute:intensity          # Computational intensity
+deprecated:replacement     # Deprecation with suggested alternative
+wraps:function            # This function wraps another
+calls:func1,func2         # Functions called internally
+see:related1,related2     # Related functions to consider
+parallel:capable          # Can use parallel processing (v3.4)
+deterministic:false       # Non-deterministic results (v3.4)
+pure:false               # Has side effects (v3.4)</code></pre>
<p><strong>9. Semantic Annotations (v3.4 New):</strong></p>
<pre><code>BEHAVIORAL:
@controls:aspect          # Parameter controls specific behavior
@affects:target          # Changes affect another component
@modifies:target         # Directly modifies target

DEPENDENCY:
@requires:condition      # Prerequisite condition
@conflicts:parameter     # Mutually exclusive with
@extends:base           # Extends functionality

VALIDATION:
@validates:constraint    # Validation rule
@range:[min,max]        # Numeric range
@length:constraint      # Length requirement
@pattern:regex          # Pattern matching

SEMANTIC ROLE:
@purpose:role           # Semantic purpose
@units:measurement      # Physical/logical units
@example:value          # Example values
@default-reason:why     # Why this default

LIFECYCLE:
@lifecycle:stage        # When relevant (init|config|runtime|cleanup)
@immutable             # Cannot be modified
@cached                # Result is cached
@lazy                  # Evaluated on demand

CONDITIONAL:
@when:condition        # Conditional applicability
@implies:consequence   # Logical implication
@if:cond @then:result  # If-then constraints</code></pre>
<p><strong>10. Structured Return Types (v3.4 New):</strong></p>
<pre><code>-&gt; lst{
  field1: type1 @annotation,
  field2: type2[constraint] @annotation,
  nested: lst{
    subfield: type
  }
}</code></pre>
<p><strong>11. Example Entry (v3.4):</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>@f analyze_model (</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  model<span class="sc">:s3:</span>lm,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  type:chr<span class="co">[</span><span class="ot">"summary"|"anova"|"diagnostics"</span><span class="co">]</span>?="summary",</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  conf.level:dbl<span class="co">[</span><span class="ot">0.5..0.99</span><span class="co">]</span>?=0.95</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>) | Analyze fitted model -&gt; lst{</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  statistics: df @purpose:results,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  plots: lst<span class="dt">&lt;</span><span class="kw">s3:ggplot</span><span class="dt">&gt;</span>? @when:type="diagnostics",</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  interpretation: chr @purpose:summary</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>}</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  +family:analysis +compute:light</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="ss">  - </span>model : @requires:fitted @validates:has-residuals</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="ss">  - </span>type : @controls:output-format @affects:return-structure</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="ss">  - </span>conf.level : @purpose:confidence @affects:statistics.ci</span></code></pre></div>
<p><strong>12. Conditional Constraints (v3.4):</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>@f process_data (</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  data:df,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  method:chr<span class="co">[</span><span class="ot">"scale"|"center"|"none"</span><span class="co">]</span>?="none",</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  scale.center:lgl?=TRUE,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  scale.scale:lgl?=TRUE</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>) | Process data with scaling options -&gt; df</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="ss">  - </span>method : @controls:processing</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="ss">  - </span>scale.center : @when:method="scale" @requires:TRUE</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>                   @when:method="center" @implies:scale.scale=FALSE</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="ss">  - </span>scale.scale : @when:method="scale" @default:TRUE</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>                  @conflicts:method="center"</span></code></pre></div>
<p><strong>13. Best Practices (v3.4):</strong> - Use specific sigils (@s3g not @g) - Always specify vector vs scalar types - Use standard type aliases (DF, Fml, V<t>) - Add constraints from match.arg/stopifnot/checks - Keep !cov lists short (3-6 classes max) - Document semantic relationships concisely - Use structured types for complex returns - Define reusable constraints with @constraint - Include conditional logic with @when/@implies - Group related functions with +family tags - Mark side effects with detailed sub-facets - Stay within budget (≤250 lines)</t></p>
<p><strong>14. Meta-Footer:</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">## Meta-Footer</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">- Micro-DSL Version: v3.4-source</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">- Package: {pkg} (Version: X.Y.Z)</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">- Generated: [ISO-8601 timestamp]</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">- Features: types[constrained] sigils[specific] metadata[rich] semantics[annotated]</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">- Coverage: {n_documented_exports} / {n_total_exports} exports</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">- Provenance: exports[NAMESPACE], enums[match.arg/switch], constraints[assertions/checks]</span></span></code></pre></div>
<p><strong>15. Export Detection Priority:</strong> 1. NAMESPACE file: <code>export()</code>, <code>S3method()</code>, <code>exportClasses()</code>, <code>exportMethods()</code>, <code>exportPattern()</code> 2. Roxygen tags: <code>@export</code> in documentation 3. If neither present: skip the symbol (do not guess or include)</p>
<p><strong>16. Inference Heuristics (apply silently):</strong> - Type from defaults: TRUE/FALSE → lgl, “text” → chr, 1L → int, 1.0 → dbl - Common patterns: data/df/tbl → DF, formula → Fml, weights → vec<dbl> - Enums: match.arg(x, c(“a”,“b”)) → chr[“a”|“b”] - Ranges: stopifnot(x &gt;= 0 &amp;&amp; x &lt;= 1) → dbl[0..1] - Side effects: file.* → fs, plot/ggplot → plot, message/cat → console - Determinism: runif/sample/rnorm → +deterministic:false</dbl></p>
<hr><div class="sourceCode" id="cb14"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>@pkg fmridataset | Unified Container for fMRI Datasets</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">## Type Aliases:</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>DF = df|tbl|data.table</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>V<span class="dt">&lt;</span><span class="kw">T</span><span class="dt">&gt;</span> = vec<span class="dt">&lt;</span><span class="kw">T</span><span class="dt">&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>Fml = s3:formula</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>Gg = s3:ggplot</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="fu">## Constraint Definitions:</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>@constraint positive_weights | Positive numeric weights</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  type: vec<span class="dt">&lt;</span><span class="kw">dbl</span><span class="dt">&gt;</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  validates: all(. &gt; 0)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="fu"># fmridataset</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="fu">## 1. Core</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>@f fmri_dataset (scans:chr[], mask:chr, TR:dbl, run_length:int[], event_table:DF?=data.frame(), base_path:chr?=".", censor:vec<span class="dt">&lt;</span><span class="kw">int</span><span class="dt">&gt;</span>?=NULL, preload:lgl?=FALSE, mode:chr<span class="co">[</span><span class="ot">"normal"|"bigvec"|"mmap"|"filebacked"</span><span class="co">]</span>?="normal", dummy_mode:lgl?=FALSE) | Create fMRI dataset -&gt; s3:fmri_dataset</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>  +family:dataset +pipe:in +side:fs<span class="co">[</span><span class="ot">read</span><span class="co">]</span> +see:fmri_mem_dataset, fmri_h5_dataset</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="ss">  - </span>scans : @requires:files-exist @purpose:data-files</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="ss">  - </span>mask : @requires:file-exist @purpose:mask-file</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="ss">  - </span>TR : @units:seconds @purpose:temporal-resolution</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="ss">  - </span>run_length : @purpose:run-lengths</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="ss">  - </span>event_table : @purpose:event-metadata</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="ss">  - </span>base_path : @purpose:relative-paths</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="ss">  - </span>censor : @purpose:exclude-scans</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="ss">  - </span>preload : @purpose:load-strategy</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="ss">  - </span>mode : @purpose:storage-mode</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="ss">  - </span>dummy_mode : @purpose:test-mode</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>@f fmri_mem_dataset (scans:lst<span class="dt">&lt;</span><span class="kw">s3:NeuroVec</span><span class="dt">&gt;</span>, mask<span class="sc">:s3:</span>NeuroVol, TR:dbl, run_length:int[], event_table:DF?=data.frame(), base_path:chr?=".", censor:vec<span class="dt">&lt;</span><span class="kw">int</span><span class="dt">&gt;</span>?=NULL) | Create in-memory fMRI dataset -&gt; s3:fmri_mem_dataset</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>  +family:dataset +pipe:in +side:fs<span class="co">[</span><span class="ot">read</span><span class="co">]</span> +see:fmri_dataset, fmri_h5_dataset</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="ss">  - </span>scans : @requires:NeuroVec-objects @purpose:data-objects</span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="ss">  - </span>mask : @requires:NeuroVol-object @purpose:mask-object</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="ss">  - </span>TR : @units:seconds @purpose:temporal-resolution</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="ss">  - </span>run_length : @purpose:run-lengths</span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="ss">  - </span>event_table : @purpose:event-metadata</span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="ss">  - </span>base_path : @purpose:relative-paths</span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="ss">  - </span>censor : @purpose:exclude-scans</span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>@f fmri_h5_dataset (h5_files:chr[], mask_source:chr|s3:NeuroVol, TR:dbl, run_length:int[], event_table:DF?=data.frame(), base_path:chr?=".", censor:vec<span class="dt">&lt;</span><span class="kw">int</span><span class="dt">&gt;</span>?=NULL, preload:lgl?=FALSE, mask_dataset:chr?="data/elements", data_dataset:chr?="data") | Create fMRI dataset from H5 files -&gt; s3:fmri_file_dataset</span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a>  +family:dataset +pipe:in +side:fs<span class="co">[</span><span class="ot">read</span><span class="co">]</span> +see:fmri_dataset, fmri_mem_dataset</span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="ss">  - </span>h5_files : @requires:files-exist @purpose:data-files</span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a><span class="ss">  - </span>mask_source : @requires:file-exist @purpose:mask-file</span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="ss">  - </span>TR : @units:seconds @purpose:temporal-resolution</span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="ss">  - </span>run_length : @purpose:run-lengths</span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="ss">  - </span>event_table : @purpose:event-metadata</span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a><span class="ss">  - </span>base_path : @purpose:relative-paths</span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="ss">  - </span>censor : @purpose:exclude-scans</span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a><span class="ss">  - </span>preload : @purpose:load-strategy</span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a><span class="ss">  - </span>mask_dataset : @purpose:mask-path</span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a><span class="ss">  - </span>data_dataset : @purpose:data-path</span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a></span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a>@f latent_dataset (source:chr[]|lst<span class="dt">&lt;</span><span class="kw">s3:LatentNeuroVec</span><span class="dt">&gt;</span>, TR:dbl, run_length:int[], event_table:DF?=data.frame(), base_path:chr?=".", censor:vec<span class="dt">&lt;</span><span class="kw">int</span><span class="dt">&gt;</span>?=NULL, preload:lgl?=FALSE) | Create latent space fMRI dataset -&gt; s3:latent_dataset</span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a>  +family:dataset +pipe:in +side:fs<span class="co">[</span><span class="ot">read</span><span class="co">]</span> +see:fmri_dataset, fmri_mem_dataset</span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a><span class="ss">  - </span>source : @requires:files-exist @purpose:data-files</span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a><span class="ss">  - </span>TR : @units:seconds @purpose:temporal-resolution</span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a><span class="ss">  - </span>run_length : @purpose:run-lengths</span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a><span class="ss">  - </span>event_table : @purpose:event-metadata</span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a><span class="ss">  - </span>base_path : @purpose:relative-paths</span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a><span class="ss">  - </span>censor : @purpose:exclude-scans</span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a><span class="ss">  - </span>preload : @purpose:load-strategy</span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a></span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a>@f get_latent_scores (x<span class="sc">:s3:</span>latent_dataset, rows:int[]?=NULL, cols:int[]?=NULL, ...:expr) | Extract latent scores -&gt; mat<span class="dt">&lt;</span><span class="kw">dbl</span><span class="dt">&gt;</span></span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a>  +family:data-access +pipe:in +see:get_spatial_loadings, reconstruct_voxels</span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a><span class="ss">  - </span>x : @purpose:dataset</span>
<span id="cb14-67"><a href="#cb14-67" tabindex="-1"></a><span class="ss">  - </span>rows : @purpose:subset-rows</span>
<span id="cb14-68"><a href="#cb14-68" tabindex="-1"></a><span class="ss">  - </span>cols : @purpose:subset-cols</span>
<span id="cb14-69"><a href="#cb14-69" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" tabindex="-1"></a>@f get_spatial_loadings (x<span class="sc">:s3:</span>latent_dataset, components:int[]?=NULL, ...:expr) | Extract spatial loadings -&gt; mat<span class="dt">&lt;</span><span class="kw">dbl</span><span class="dt">&gt;</span></span>
<span id="cb14-71"><a href="#cb14-71" tabindex="-1"></a>  +family:data-access +pipe:in +see:get_latent_scores, reconstruct_voxels</span>
<span id="cb14-72"><a href="#cb14-72" tabindex="-1"></a><span class="ss">  - </span>x : @purpose:dataset</span>
<span id="cb14-73"><a href="#cb14-73" tabindex="-1"></a><span class="ss">  - </span>components : @purpose:subset-components</span>
<span id="cb14-74"><a href="#cb14-74" tabindex="-1"></a></span>
<span id="cb14-75"><a href="#cb14-75" tabindex="-1"></a>@f get_component_info (x<span class="sc">:s3:</span>latent_dataset, ...:expr) | Get component metadata -&gt; lst</span>
<span id="cb14-76"><a href="#cb14-76" tabindex="-1"></a>  +family:data-access +pipe:in +see:get_latent_scores, get_spatial_loadings</span>
<span id="cb14-77"><a href="#cb14-77" tabindex="-1"></a><span class="ss">  - </span>x : @purpose:dataset</span>
<span id="cb14-78"><a href="#cb14-78" tabindex="-1"></a></span>
<span id="cb14-79"><a href="#cb14-79" tabindex="-1"></a>@f reconstruct_voxels (x<span class="sc">:s3:</span>latent_dataset, rows:int[]?=NULL, voxels:int[]?=NULL, ...:expr) | Reconstruct voxel data -&gt; mat<span class="dt">&lt;</span><span class="kw">dbl</span><span class="dt">&gt;</span></span>
<span id="cb14-80"><a href="#cb14-80" tabindex="-1"></a>  +family:data-access +pipe:in +see:get_latent_scores, get_spatial_loadings</span>
<span id="cb14-81"><a href="#cb14-81" tabindex="-1"></a><span class="ss">  - </span>x : @purpose:dataset</span>
<span id="cb14-82"><a href="#cb14-82" tabindex="-1"></a><span class="ss">  - </span>rows : @purpose:subset-rows</span>
<span id="cb14-83"><a href="#cb14-83" tabindex="-1"></a><span class="ss">  - </span>voxels : @purpose:subset-voxels</span>
<span id="cb14-84"><a href="#cb14-84" tabindex="-1"></a></span>
<span id="cb14-85"><a href="#cb14-85" tabindex="-1"></a>@f fmri_series (dataset<span class="sc">:s3:</span>fmri_dataset, selector:any?=NULL, timepoints:int[]?=NULL, output:chr<span class="co">[</span><span class="ot">"fmri_series"|"DelayedMatrix"</span><span class="co">]</span>?="fmri_series", event_window:any?=NULL, ...:expr) | Query fMRI time series -&gt; s3:fmri_series|DelayedMatrix</span>
<span id="cb14-86"><a href="#cb14-86" tabindex="-1"></a>  +family:data-access +pipe:in +see:fmri_dataset, fmri_mem_dataset</span>
<span id="cb14-87"><a href="#cb14-87" tabindex="-1"></a><span class="ss">  - </span>dataset : @purpose:dataset</span>
<span id="cb14-88"><a href="#cb14-88" tabindex="-1"></a><span class="ss">  - </span>selector : @purpose:spatial-selector</span>
<span id="cb14-89"><a href="#cb14-89" tabindex="-1"></a><span class="ss">  - </span>timepoints : @purpose:temporal-selector</span>
<span id="cb14-90"><a href="#cb14-90" tabindex="-1"></a><span class="ss">  - </span>output : @purpose:return-format</span>
<span id="cb14-91"><a href="#cb14-91" tabindex="-1"></a></span>
<span id="cb14-92"><a href="#cb14-92" tabindex="-1"></a>@f fmri_group (subjects:DF, id:chr, dataset_col:chr?="dataset", space:chr?=NULL, mask_strategy:chr<span class="co">[</span><span class="ot">"subject_specific"|"intersect"|"union"</span><span class="co">]</span>?="subject_specific") | Create fMRI group -&gt; s3:fmri_group</span>
<span id="cb14-93"><a href="#cb14-93" tabindex="-1"></a>  +family:group +pipe:in +see:fmri_dataset, fmri_mem_dataset</span>
<span id="cb14-94"><a href="#cb14-94" tabindex="-1"></a><span class="ss">  - </span>subjects : @purpose:subject-data</span>
<span id="cb14-95"><a href="#cb14-95" tabindex="-1"></a><span class="ss">  - </span>id : @purpose:identifier</span>
<span id="cb14-96"><a href="#cb14-96" tabindex="-1"></a><span class="ss">  - </span>dataset_col : @purpose:dataset-column</span>
<span id="cb14-97"><a href="#cb14-97" tabindex="-1"></a><span class="ss">  - </span>space : @purpose:common-space</span>
<span id="cb14-98"><a href="#cb14-98" tabindex="-1"></a><span class="ss">  - </span>mask_strategy : @purpose:mask-strategy</span>
<span id="cb14-99"><a href="#cb14-99" tabindex="-1"></a></span>
<span id="cb14-100"><a href="#cb14-100" tabindex="-1"></a>@f iter_subjects (gd<span class="sc">:s3:</span>fmri_group, order_by:chr?=NULL) | Iterate subjects -&gt; lst</span>
<span id="cb14-101"><a href="#cb14-101" tabindex="-1"></a>  +family:group +pipe:in +see:fmri_group, fmri_dataset</span>
<span id="cb14-102"><a href="#cb14-102" tabindex="-1"></a><span class="ss">  - </span>gd : @purpose:group-dataset</span>
<span id="cb14-103"><a href="#cb14-103" tabindex="-1"></a><span class="ss">  - </span>order_by : @purpose:order-iteration</span>
<span id="cb14-104"><a href="#cb14-104" tabindex="-1"></a></span>
<span id="cb14-105"><a href="#cb14-105" tabindex="-1"></a>@f group_map (gd<span class="sc">:s3:</span>fmri_group, .f:fml, ..., out:chr<span class="co">[</span><span class="ot">"list"|"bind_rows"</span><span class="co">]</span>?="list", order_by:chr?=NULL, on_error:chr<span class="co">[</span><span class="ot">"stop"|"warn"|"skip"</span><span class="co">]</span>?="stop") | Map function over subjects -&gt; lst|DF</span>
<span id="cb14-106"><a href="#cb14-106" tabindex="-1"></a>  +family:group +pipe:in +see:fmri_group, fmri_dataset</span>
<span id="cb14-107"><a href="#cb14-107" tabindex="-1"></a><span class="ss">  - </span>gd : @purpose:group-dataset</span>
<span id="cb14-108"><a href="#cb14-108" tabindex="-1"></a><span class="ss">  - </span>.f : @purpose:map-function</span>
<span id="cb14-109"><a href="#cb14-109" tabindex="-1"></a><span class="ss">  - </span>... : @purpose:additional-args</span>
<span id="cb14-110"><a href="#cb14-110" tabindex="-1"></a><span class="ss">  - </span>out : @purpose:output-format</span>
<span id="cb14-111"><a href="#cb14-111" tabindex="-1"></a><span class="ss">  - </span>order_by : @purpose:order-iteration</span>
<span id="cb14-112"><a href="#cb14-112" tabindex="-1"></a><span class="ss">  - </span>on_error : @purpose:error-handling</span>
<span id="cb14-113"><a href="#cb14-113" tabindex="-1"></a></span>
<span id="cb14-114"><a href="#cb14-114" tabindex="-1"></a>@f group_reduce (gd<span class="sc">:s3:</span>fmri_group, .map:fml, .reduce:fml, .init:any, order_by:chr?=NULL, on_error:chr<span class="co">[</span><span class="ot">"stop"|"warn"|"skip"</span><span class="co">]</span>?="stop", ...) | Reduce over subjects -&gt; any</span>
<span id="cb14-115"><a href="#cb14-115" tabindex="-1"></a>  +family:group +pipe:in +see:fmri_group, fmri_dataset</span>
<span id="cb14-116"><a href="#cb14-116" tabindex="-1"></a><span class="ss">  - </span>gd : @purpose:group-dataset</span>
<span id="cb14-117"><a href="#cb14-117" tabindex="-1"></a><span class="ss">  - </span>.map : @purpose:map-function</span>
<span id="cb14-118"><a href="#cb14-118" tabindex="-1"></a><span class="ss">  - </span>.reduce : @purpose:reduce-function</span>
<span id="cb14-119"><a href="#cb14-119" tabindex="-1"></a><span class="ss">  - </span>.init : @purpose:initial-value</span>
<span id="cb14-120"><a href="#cb14-120" tabindex="-1"></a><span class="ss">  - </span>order_by : @purpose:order-iteration</span>
<span id="cb14-121"><a href="#cb14-121" tabindex="-1"></a><span class="ss">  - </span>on_error : @purpose:error-handling</span>
<span id="cb14-122"><a href="#cb14-122" tabindex="-1"></a></span>
<span id="cb14-123"><a href="#cb14-123" tabindex="-1"></a>@f filter_subjects (gd<span class="sc">:s3:</span>fmri_group, ...:expr) | Filter subjects -&gt; s3:fmri_group</span>
<span id="cb14-124"><a href="#cb14-124" tabindex="-1"></a>  +family:group +pipe:in +see:fmri_group, fmri_dataset</span>
<span id="cb14-125"><a href="#cb14-125" tabindex="-1"></a><span class="ss">  - </span>gd : @purpose:group-dataset</span>
<span id="cb14-126"><a href="#cb14-126" tabindex="-1"></a><span class="ss">  - </span>... : @purpose:filter-expressions</span>
<span id="cb14-127"><a href="#cb14-127" tabindex="-1"></a></span>
<span id="cb14-128"><a href="#cb14-128" tabindex="-1"></a>@f mutate_subjects (gd<span class="sc">:s3:</span>fmri_group, ...:expr) | Mutate subject attributes -&gt; s3:fmri_group</span>
<span id="cb14-129"><a href="#cb14-129" tabindex="-1"></a>  +family:group +pipe:in +see:fmri_group, fmri_dataset</span>
<span id="cb14-130"><a href="#cb14-130" tabindex="-1"></a><span class="ss">  - </span>gd : @purpose:group-dataset</span>
<span id="cb14-131"><a href="#cb14-131" tabindex="-1"></a><span class="ss">  - </span>... : @purpose:mutate-expressions</span>
<span id="cb14-132"><a href="#cb14-132" tabindex="-1"></a></span>
<span id="cb14-133"><a href="#cb14-133" tabindex="-1"></a>@f left_join_subjects (gd<span class="sc">:s3:</span>fmri_group, y:DF, by:chr?=NULL, ...) | Left join subject metadata -&gt; s3:fmri_group</span>
<span id="cb14-134"><a href="#cb14-134" tabindex="-1"></a>  +family:group +pipe:in +see:fmri_group, fmri_dataset</span>
<span id="cb14-135"><a href="#cb14-135" tabindex="-1"></a><span class="ss">  - </span>gd : @purpose:group-dataset</span>
<span id="cb14-136"><a href="#cb14-136" tabindex="-1"></a><span class="ss">  - </span>y : @purpose:join-data</span>
<span id="cb14-137"><a href="#cb14-137" tabindex="-1"></a><span class="ss">  - </span>by : @purpose:join-keys</span>
<span id="cb14-138"><a href="#cb14-138" tabindex="-1"></a></span>
<span id="cb14-139"><a href="#cb14-139" tabindex="-1"></a>@f sample_subjects (gd<span class="sc">:s3:</span>fmri_group, n:int, replace:lgl?=FALSE, strata:chr?=NULL) | Sample subjects -&gt; s3:fmri_group</span>
<span id="cb14-140"><a href="#cb14-140" tabindex="-1"></a>  +family:group +pipe:in +see:fmri_group, fmri_dataset</span>
<span id="cb14-141"><a href="#cb14-141" tabindex="-1"></a><span class="ss">  - </span>gd : @purpose:group-dataset</span>
<span id="cb14-142"><a href="#cb14-142" tabindex="-1"></a><span class="ss">  - </span>n : @purpose:sample-size</span>
<span id="cb14-143"><a href="#cb14-143" tabindex="-1"></a><span class="ss">  - </span>replace : @purpose:sample-replacement</span>
<span id="cb14-144"><a href="#cb14-144" tabindex="-1"></a><span class="ss">  - </span>strata : @purpose:sample-strata</span>
<span id="cb14-145"><a href="#cb14-145" tabindex="-1"></a></span>
<span id="cb14-146"><a href="#cb14-146" tabindex="-1"></a>@f stream_subjects (gd<span class="sc">:s3:</span>fmri_group, prefetch:int?=1, order_by:chr?=NULL) | Stream subjects -&gt; lst</span>
<span id="cb14-147"><a href="#cb14-147" tabindex="-1"></a>  +family:group +pipe:in +see:fmri_group, fmri_dataset</span>
<span id="cb14-148"><a href="#cb14-148" tabindex="-1"></a><span class="ss">  - </span>gd : @purpose:group-dataset</span>
<span id="cb14-149"><a href="#cb14-149" tabindex="-1"></a><span class="ss">  - </span>prefetch : @purpose:prefetch-size</span>
<span id="cb14-150"><a href="#cb14-150" tabindex="-1"></a><span class="ss">  - </span>order_by : @purpose:order-iteration</span>
<span id="cb14-151"><a href="#cb14-151" tabindex="-1"></a></span>
<span id="cb14-152"><a href="#cb14-152" tabindex="-1"></a><span class="fu">## Dependencies</span></span>
<span id="cb14-153"><a href="#cb14-153" tabindex="-1"></a><span class="ss">- </span>Imports: assertthat, cachem, deflist, fmrihrf, fs, lifecycle, memoise, Matrix, methods, neuroim2, purrr, tibble, DelayedArray, S4Vectors, utils</span>
<span id="cb14-154"><a href="#cb14-154" tabindex="-1"></a><span class="ss">- </span>Suggests: bench, bidser, crayon, arrow, dplyr, fmristore, foreach, mockery, mockr, Rarr, testthat (&gt;= 3.0.0), knitr, rmarkdown</span>
<span id="cb14-155"><a href="#cb14-155" tabindex="-1"></a></span>
<span id="cb14-156"><a href="#cb14-156" tabindex="-1"></a>---</span>
<span id="cb14-157"><a href="#cb14-157" tabindex="-1"></a><span class="fu">## Meta-Footer</span></span>
<span id="cb14-158"><a href="#cb14-158" tabindex="-1"></a><span class="ss">- </span>Micro-DSL Version: v3.4-source</span>
<span id="cb14-159"><a href="#cb14-159" tabindex="-1"></a><span class="ss">- </span>Package: fmridataset (Version: 0.8.9)</span>
<span id="cb14-160"><a href="#cb14-160" tabindex="-1"></a><span class="ss">- </span>Generated: 2023-10-05T12<span class="sc">:00:</span>00Z</span>
<span id="cb14-161"><a href="#cb14-161" tabindex="-1"></a><span class="ss">- </span>Features: types<span class="co">[</span><span class="ot">constrained</span><span class="co">]</span> sigils<span class="co">[</span><span class="ot">specific</span><span class="co">]</span> metadata<span class="co">[</span><span class="ot">rich</span><span class="co">]</span> semantics<span class="co">[</span><span class="ot">annotated</span><span class="co">]</span></span>
<span id="cb14-162"><a href="#cb14-162" tabindex="-1"></a><span class="ss">- </span>Coverage: 50 / 50 exports</span>
<span id="cb14-163"><a href="#cb14-163" tabindex="-1"></a><span class="ss">- </span>Provenance: exports<span class="co">[</span><span class="ot">NAMESPACE</span><span class="co">]</span>, enums<span class="co">[</span><span class="ot">match.arg/switch</span><span class="co">]</span>, constraints<span class="co">[</span><span class="ot">assertions/checks</span><span class="co">]</span></span></code></pre></div>
</div>

  </main></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

